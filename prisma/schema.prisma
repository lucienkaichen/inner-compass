
generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "rhel-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Entry {
  id        Int      @id @default(autoincrement())
  content   String
  mood      String? 
  tags      String?  
  analysis  Analysis?
  tools     Tool[]   
  createdAt DateTime @default(now())
}

model Analysis {
  id        Int      @id @default(autoincrement())
  entryId   Int      @unique
  entry     Entry    @relation(fields: [entryId], references: [id], onDelete: Cascade)
  summary   String?
  aiReply   String?     // New: Conversational feedback
  patterns  String?  
  emotionTags String? 
  connections String? 
  customInsights String? 
  createdAt DateTime @default(now())
}

model Strategy {
  id        Int      @id @default(autoincrement())
  title     String
  content   String
  category  String?  
  trigger   String?  
  isAiGenerated Boolean @default(false)
  createdAt DateTime @default(now())
}

model EmotionGuide {
  id        Int      @id @default(autoincrement())
  emotion   String   @unique
  strategy  String   
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Inner Compass 3.0 New Models

model Quote {
  id        Int      @id @default(autoincrement())
  content   String
  source    String?
  isActive  Boolean  @default(true)
  isPinned  Boolean  @default(false)
  createdAt DateTime @default(now())
}

model Tool {
  id        Int      @id @default(autoincrement())
  title     String
  content   String
  category  String?
  tags      String? 
  sourceEntryId Int?
  sourceEntry   Entry? @relation(fields: [sourceEntryId], references: [id])
  isAiGenerated Boolean @default(false)
  createdAt DateTime @default(now())
}

model Profile {
  id        Int      @id @default(autoincrement())
  content   String   // Long text: Personality Analysis
  updatedAt DateTime @updatedAt
}

model UserSettings {
  id          Int      @id @default(autoincrement())
  aiPersona   String?  // The user's custom instructions for AI
  geminiApiKey String? // User provided API Key (Overrides env var)
  updatedAt   DateTime @updatedAt
}
